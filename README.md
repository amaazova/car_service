## Описание проекта ##

Этот проект посвящен исследованию линейных регрессий с использованием регуляризации (Lasso и Ridge) для предсказания стоимости автомобилей. Основной задачей было изучение влияния признаков и их трансформаций на метрики модели, а также создание REST API для автоматизации инференса.

Основные этапы работы

1. Предобработка данных

Цели этапа:

	•	Очистить данные от пропусков и аномалий.
	•	Преобразовать текстовые части числовых признаков (например, engine и max_power).
	•	Подготовить данные для обучения и тестирования.

Шаги:

	•	Удалены пропуски: в числовых признаках применена медиана.
	•	Преобразованы текстовые данные в числовые.
	•	Категориальные признаки закодированы через One-Hot Encoding.
	•	Применён StandardScaler для стандартизации вещественных признаков.

Вывод:

	•	Стандартизация признаков открыла возможность эффективно обучать регуляризованные модели.
	•	Кодирование категориальных данных улучшило общий процесс интерпретации.

2. Исследовательский анализ данных (EDA)

Основные действия:

	•	Построены попарные распределения для признаков через pairplot.
	•	Проверены корреляции между признаками и целевой переменной.

Вывод:

	•	Многие  признаки, такие как engine и max_power,например,  продемонстрировали высокую значимость.
	•	Категориальные признаки также внесли вклад в итоговую модель.

3. Построение моделей и их анализ

Применённые методы:

1. Отправная точка анализа

	•	Линейная регрессия служила базовой моделью для оценки зависимости между признаками и целевой переменной.
	•	Она позволила быстро получить первые метрики (R², MSE) и понять структуру данных без использования регуляризации.

2.	Lasso-регрессия:
	•	Подбор гиперпараметра alpha с использованием GridSearchCV.
	•	Оптимизация на 10-кратной кросс-валидации.
	•	Итоговый alpha = 1000.0, но R² на кросс-валидации оказался отрицательным из-за низкой объяснённой дисперсии.
	
3.	Ridge-регрессия:
	2. Результаты на тренировочном и тестовом наборах

	•	Ridge продемонстрировала стабильные метрики на тренировочной и тестовой выборках.
	•	На тестовом наборе качество предсказаний оказалось лучше, чем у линейной и Lasso-регрессий, благодаря более сбалансированному распределению весов признаков.

3. Результаты на кросс-валидации

	•	Отрицательный R² на кросс-валидации указывает на ограничение модели в объяснении вариаций данных в отдельных фолдах.
	•	Возможные причины:
	•	Несбалансированность данных между фолдами.
	•	Высокий уровень шума или выбросов в данных.
	•	Неоптимальный диапазон для гиперпараметра alpha.


4. Бизнес-метрики

	•	Введена метрика: доля предсказаний с точностью до 10% от фактической цены.
	•	Ridge показал лучшие результаты:
	•	Тренировочный набор: 21.97%
	•	Тестовый набор: 25.30%.

5. Создание REST API

Почему Lasso?

1. Интерпретация результатов модели

	•	Lasso-регрессия автоматически зануляет коэффициенты менее значимых признаков. Это делает модель:
	•	Пространственно экономной: модель использует меньше признаков.
	•	Более интерпретируемой: легко объяснить влияние каждого признака на результат.
	•	В бизнес-задачах, где важна простота и интерпретация, Lasso предпочтительна, даже если качество предсказаний немного уступает Ridge.

2. Устойчивость к шуму

	•	Lasso лучше справляется с задачами, где признаки имеют разное значение. Например, в данном случае признаки engine и max_power оказывают большее влияние, а менее важные (например, seats) могут быть занулены. Это снижает вероятность переобучения.


3. Скорость работы

	•	В некоторых случаях Lasso работает быстрее Ridge при большом количестве признаков за счёт отбора только ключевых. Это может быть полезным для API, где важна скорость обработки данных.

Разработан API на основе FastAPI с тремя эндпоинтами:

	1.	/predict_item: предсказание стоимости одного автомобиля.
	2.	/predict_items: предсказание стоимости для набора автомобилей.
	3.	/predict_csv: загрузка CSV-файла с данными, возвращается файл с предсказаниями.





- ![Снимок экрана 2024-12-03 в 21.09.01](images/Снимок%20экрана%202024-12-03%20в%2021.09.01.png)
- ![Снимок экрана 2024-12-03 в 21.09.13](images/Снимок%20экрана%202024-12-03%20в%2021.09.13.png)
- ![Снимок экрана 2024-12-03 в 21.09.24](images/Снимок%20экрана%202024-12-03%20в%2021.09.24.png)
- ![Снимок экрана 2024-12-03 в 21.09.31](images/Снимок%20экрана%202024-12-03%20в%2021.09.31.png)
- ![Снимок экрана 2024-12-03 в 21.09.45](images/Снимок%20экрана%202024-12-03%20в%2021.09.45.png)
